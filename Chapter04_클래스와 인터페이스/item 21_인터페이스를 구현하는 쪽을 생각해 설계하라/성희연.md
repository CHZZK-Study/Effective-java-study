## item 21. 인터페이스를 구현하는 쪽을 생각해 설계하라

---

### 1. `Default method`?

보통 `interface`에 메서드를 추가하면 보통은 컴파일 오류가 발생한다.  
`interface`를 상속(`implements`)한 클래스는 `interface`에 선언된 메서드들을 모두 구현해야 하는데, 새로 추가된 메서드가 기존의 클래스에 이미 존재하고 있을 가능성은 거의 없기 때문이다.

Java 8 이전(Java 7까지)에는 `interface`에 새로운 메서드가 추가될 일이 없다고 가정했기 때문에 이러한 일이 발생했다.

Java 8부터는 위에서 이야기했던 문제점을 해결하기 위해 `Default method`라는 것을 도입했다.  

```java
public interface MyInterface {
    
    void method1();
    
    default void defaultMethod() {
        // default method implementation
        // 이 메서드를 구현하지 않아도 동작할 수 있게끔, 기본 동작 방식을 서술
    }
}
```

위 코드와 같이, `interface`를 상속한 클래스가 해당 메서드(`defaultMethod`)를 구현하지 않더라도 컴파일 오류 없이 동작하게끔 기본적인 동작 방법을 서술하는 것을 이야기한다.

---

### 2. `Default method`의 문제점과 해결 방법

그럼 `Default method` 도입 이후에 모든게 완벽하게 해결이 된걸까?  
슬프게도 그렇지 않다.

> `Default method`는 구현 클래스에 대해 아무것도 모르고, 그저 무작정 '삽입'되는 것이다.  

따라서 이와 관련된 문제가 발생할 수 있다.

`Default method`는 컴파일에 성공하더라도(`compile` 오류가 발생하지 않더라도), 기존 구현체에 `runtime` 오류를 일으킬 수 있다.  
Java 8의 `Collection interface`에는 꽤 많은 `default method`가 추가 되었는데,  그 결과 기존에 짜여진 많은 자바 코드가 영향을 미쳤다고 알려져있다.  

기존 인터페이스에 디폴트 메서드를 이용하여 새로운 메서드를 추가하는 일은 꼭 필요한 경우가 아니면 피하는 것을 권장한다.  
만일 디폴트 메서드를 추가하게 된다면, 해당 디폴트 메서드가 기존 구현체들과 충돌을 일으키지는 않을지 심사숙고해야 한다.

또한 디폴트 메서드는 인터페이스로부터 메서드를 제거하거나, 기존 메서드의 시그니처를 변경하는 용도가 아님을 명심해야 한다.


릴리스 전에 반드시 테스트를 거쳐야하며, 적어도 서로 다른 구현체 세 가지를 만들어 테스트를 해보아야 한다.   
릴리스 이전에, 즉 바로 잡을 기회가 있을 때 결함을 찾아서 수정하는 것이 좋다.











